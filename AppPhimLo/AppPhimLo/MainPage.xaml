<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:AppPhimLo"
             x:Class="AppPhimLo.MainPage">

    <ScrollView>
        <VerticalStackLayout Background="#191b24">
            <StackLayout Margin="0,0,0,50" HorizontalOptions="FillAndExpand">
                <Grid HeightRequest="500">
                    <CarouselView x:Name="carousel"
                      ItemsSource="{Binding MoviesTQ}"
                      IsSwipeEnabled="False"
                      IndicatorView="indicatorView"
                      HorizontalOptions="FillAndExpand"
                      VerticalOptions="FillAndExpand">
                        <CarouselView.ItemsLayout>
                            <LinearItemsLayout Orientation="Horizontal" ItemSpacing="10"/>
                        </CarouselView.ItemsLayout>
                        <CarouselView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <!-- Ảnh nền -->
                                    <Image Source="{Binding FullThumbUrl}"
                               Aspect="AspectFill"
                               HorizontalOptions="FillAndExpand"
                               VerticalOptions="FillAndExpand"/>

                                    <!-- Shadow overlay ở dưới -->
                                    <BoxView VerticalOptions="End"
                                 HeightRequest="120"
                                 HorizontalOptions="FillAndExpand"
                                 Opacity="0.8">
                                        <BoxView.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                <GradientStop Color="Transparent" Offset="0.0"/>
                                                <GradientStop Color="Black" Offset="1.0"/>
                                            </LinearGradientBrush>
                                        </BoxView.Background>
                                    </BoxView>
                                </Grid>
                            </DataTemplate>
                        </CarouselView.ItemTemplate>
                    </CarouselView>

                  
                    <Button Text="❮"
                BackgroundColor="#66000000"
                TextColor="White"
                FontSize="36"
                WidthRequest="60"
                HeightRequest="60"
                CornerRadius="30"
                VerticalOptions="Center"
                HorizontalOptions="Start"
                Margin="10,0"
                Clicked="OnLeftTapped"
                ZIndex="1"/>
                   
                    <Button Text="❯"
                BackgroundColor="#66000000"
                TextColor="White"
                FontSize="36"
                WidthRequest="60"
                HeightRequest="60"
                CornerRadius="30"
                VerticalOptions="Center"
                HorizontalOptions="End"
                Margin="10,0"
                Clicked="OnRightTapped"
                ZIndex="1"/>
                </Grid>

                <!-- IndicatorView -->
                <IndicatorView x:Name="indicatorView"
                   IndicatorColor="LightGray"
                   SelectedIndicatorColor="Red"
                   HorizontalOptions="Center"
                   IndicatorsShape="Circle"
                   IndicatorSize="12"
                   Margin="0,10,0,0"/>
            </StackLayout>

            <StackLayout Orientation="Horizontal" Margin="0,20,0,20">
                <Label Text="Thể loại"
                        FontSize="20"
                        FontAttributes="Bold"
                       FontFamily="Anton"
                        Margin="10,0"
                        TextColor="#fff"/>
                 </StackLayout>
                <CollectionView ItemsSource="{Binding TheLoais}"
                              HorizontalScrollBarVisibility="Never"
                              Margin="0,0,0,10"
                              HeightRequest="150">
                              <CollectionView.ItemsLayout>
                                  <LinearItemsLayout Orientation="Horizontal" ItemSpacing="15"/>
                              </CollectionView.ItemsLayout>

                              <CollectionView.ItemTemplate>
                        <DataTemplate>
                          <Frame WidthRequest="160"
                                 HeightRequest="120"
                                 CornerRadius="15"
                                 Padding="10"
                                 HasShadow="False"
                                 BackgroundColor="{Binding Color}">
                            <StackLayout VerticalOptions="Center" HorizontalOptions="Center" Spacing="5">
                                <Label Text="{Binding Name}"
                                      FontAttributes="Bold"
                                      FontSize="25"
                                      FontFamily="Anton"
                                      TextColor="#fff"
                                      HorizontalTextAlignment="Center"
                                      VerticalTextAlignment="Center"/>
                                           <Label Text="Xem chủ đề >"
                                      FontSize="12"
                                      
                                      TextColor="#191b24"
                                      HorizontalTextAlignment="Center"/>
                            </StackLayout>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroupList>
                                    <VisualStateGroup Name="CommonStates">
                                        <VisualState Name="Normal">
                                            <VisualState.Setters>
                                                <Setter Property="TranslationY" Value="0"/>
                                            </VisualState.Setters>
                                        </VisualState>
                                        <VisualState Name="PointerOver">
                                            <VisualState.Setters>
                                                <Setter Property="TranslationY" Value="-8"/>
                                            </VisualState.Setters>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateGroupList>
                            </VisualStateManager.VisualStateGroups>

                        </Frame>
                        </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>



            <StackLayout Orientation="Horizontal" Margin="0,20,0,20">
                <Label Text="Phim Trung Quốc"
           FontSize="20"
           FontFamily="Anton"
           FontAttributes="Bold"
           Margin="10,0"
           TextColor="#fff"/>
            </StackLayout>
            <CollectionView ItemsSource="{Binding MoviesTQ}"
                HorizontalScrollBarVisibility="Never"
                Margin="0,0,0,10"
                HeightRequest="250">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" ItemSpacing="15"/>
                </CollectionView.ItemsLayout>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame WidthRequest="160" HeightRequest="260"
                              CornerRadius="15"
                              Padding="0"
                              Margin="5"
                              HasShadow="True"
                              BackgroundColor="#222">
                            <Grid RowDefinitions="180,Auto">
                                <Image Source="{Binding FullThumbUrl}"
                                 Aspect="AspectFill"
                                 HorizontalOptions="Fill"
                                 VerticalOptions="Fill">
                                </Image>
                                <Label Grid.Row="1"
                           Text="{Binding name}" 
                           FontAttributes="Bold"
                           FontSize="13"
                           
                           LineBreakMode="TailTruncation"
                           MaxLines="2"
                           HorizontalOptions="Center"
                           VerticalOptions="Start"
                           Margin="8,6,8,0"
                           HorizontalTextAlignment="Center"
                           TextColor="White"/>

                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroupList>
                                    <VisualStateGroup>
                                        <VisualState Name="Normal">
                                            <VisualState.Setters>
                                                <Setter Property="TranslationY" Value="0"/>
                                                <Setter Property="Scale" Value="1"/>
                                            </VisualState.Setters>
                                        </VisualState>
                                        <VisualState Name="PointerOver">
                                            <VisualState.Setters>
                                                <Setter Property="TranslationY" Value="-8"/>
                                                <Setter Property="Scale" Value="1.05"/>
                                            </VisualState.Setters>
                                        </VisualState>
                                    </VisualStateGroup>
                                    </VisualStateGroupList>
                                </VisualStateManager.VisualStateGroups>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            <StackLayout Orientation="Horizontal"
                         HorizontalOptions="End">
                <Label Text="Xem toàn bộ >"
                         FontSize="15"
                       
                         FontAttributes="Bold"
                         Margin="0,0,10,30"
                         TextColor="#fff">
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroupList>
                            <VisualStateGroup Name="CommonStates">
                                <VisualState Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="TranslationY" Value="0"/>
                                        <Setter Property="TextColor" Value="White"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Property="TranslationX" Value="8"/>
                                        <Setter Property="TextColor" Value="Yellow"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateGroupList>
                    </VisualStateManager.VisualStateGroups>
                </Label>
            </StackLayout>

            <StackLayout Orientation="Horizontal" Margin="0,20,0,20">
                <Label Text="Phim Hàn Quốc"
                    FontSize="20"
                       FontFamily="Anton"
                    FontAttributes="Bold"
                    Margin="10,0"
                    TextColor="#fff"/>
            </StackLayout>
            <CollectionView ItemsSource="{Binding MoviesHQ}"
     HorizontalScrollBarVisibility="Never"
     Margin="0,0,0,10"
     HeightRequest="250">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" ItemSpacing="15"/>
                </CollectionView.ItemsLayout>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame WidthRequest="160" HeightRequest="260"
                              CornerRadius="15"
                              Padding="0"
                              Margin="5"
                              HasShadow="True"
                              BackgroundColor="#222">
                            <Grid RowDefinitions="180,Auto">
                                <Image Source="{Binding FullThumbUrl}"
                                           Aspect="AspectFill"
                                           HorizontalOptions="Fill"
                                           VerticalOptions="Fill">
                                                     </Image>
                                                     <Label Grid.Row="1"
                                     Text="{Binding name}" 
                                     FontAttributes="Bold"
                                     FontSize="13"
                                     
                                     LineBreakMode="TailTruncation"
                                     MaxLines="2"
                                     HorizontalOptions="Center"
                                     VerticalOptions="Start"
                                     Margin="8,6,8,0"
                                     HorizontalTextAlignment="Center"
                                     TextColor="White"/>

                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroupList>
                                        <VisualStateGroup>
                                            <VisualState Name="Normal">
                                                <VisualState.Setters>
                                                    <Setter Property="TranslationY" Value="0"/>
                                                    <Setter Property="Scale" Value="1"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                            <VisualState Name="PointerOver">
                                                <VisualState.Setters>
                                                    <Setter Property="TranslationY" Value="-8"/>
                                                    <Setter Property="Scale" Value="1.05"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateGroupList>
                                </VisualStateManager.VisualStateGroups>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            <StackLayout Orientation="Horizontal"
              HorizontalOptions="End">
                <Label Text="Xem toàn bộ >"
              FontSize="15"
              FontAttributes="Bold"
              Margin="0,0,10,30"
              TextColor="#fff">
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroupList>
                            <VisualStateGroup Name="CommonStates">
                                <VisualState Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="TranslationY" Value="0"/>
                                        <Setter Property="TextColor" Value="White"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Property="TranslationX" Value="8"/>
                                        <Setter Property="TextColor" Value="Yellow"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateGroupList>
                    </VisualStateManager.VisualStateGroups>
                </Label>
            </StackLayout>
            
            
            
            <StackLayout Orientation="Horizontal" Margin="0,20,0,20">
                <Label Text="Phim Việt Nam"
               FontSize="20"
               FontAttributes="Bold"
               FontFamily="Anton"
               Margin="10,0"
               TextColor="#fff"/>
            </StackLayout>
            <CollectionView ItemsSource="{Binding MoviesVN}"
                    HorizontalScrollBarVisibility="Never"
                    Margin="0,0,0,10"
                    HeightRequest="250">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" ItemSpacing="15"/>
                </CollectionView.ItemsLayout>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame WidthRequest="160" HeightRequest="260"
                             CornerRadius="15"
                             Padding="0"
                             Margin="5"
                             HasShadow="True"
                             BackgroundColor="#222">
                            <Grid RowDefinitions="180,Auto">
                                <Image Source="{Binding FullThumbUrl}"
                                 Aspect="AspectFill"
                                 HorizontalOptions="Fill"
                                 VerticalOptions="Fill">
                                </Image>
                                <Label Grid.Row="1"
                                     Text="{Binding name}" 
                                     FontAttributes="Bold"
                                     FontSize="13"
                                     LineBreakMode="TailTruncation"
                                     MaxLines="2"
                                     
                                     HorizontalOptions="Center"
                                     VerticalOptions="Start"
                                     Margin="8,6,8,0"
                                     HorizontalTextAlignment="Center"
                                     TextColor="White"/>

                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroupList>
                                        <VisualStateGroup>
                                            <VisualState Name="Normal">
                                                <VisualState.Setters>
                                                    <Setter Property="TranslationY" Value="0"/>
                                                    <Setter Property="Scale" Value="1"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                            <VisualState Name="PointerOver">
                                                <VisualState.Setters>
                                                    <Setter Property="TranslationY" Value="-8"/>
                                                    <Setter Property="Scale" Value="1.05"/>
                                                </VisualState.Setters>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateGroupList>
                                </VisualStateManager.VisualStateGroups>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            <StackLayout Orientation="Horizontal"
                 HorizontalOptions="End">
                               <Label Text="Xem toàn bộ >"
                 FontSize="15"
                 FontAttributes="Bold"
                 Margin="0,0,10,30"
                 TextColor="#fff">
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroupList>
                            <VisualStateGroup Name="CommonStates">
                                <VisualState Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="TranslationY" Value="0"/>
                                        <Setter Property="TextColor" Value="White"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Property="TranslationX" Value="8"/>
                                        <Setter Property="TextColor" Value="Yellow"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateGroupList>
                    </VisualStateManager.VisualStateGroups>
                </Label>
            </StackLayout>


            <StackLayout Orientation="Horizontal" Margin="0,20,0,20">
                <Label Text="Phim Tổng hợp"
                    FontSize="20"
                    FontAttributes="Bold"
                    FontFamily="Anton"
                    Margin="10,0"
                    TextColor="#fff"/>
            </StackLayout>
            <StackLayout Orientation="Vertical">
                
                <!-- Loading -->
                <ActivityIndicator 
                    x:Name="LoadingIndicator"
                    IsRunning="{Binding IsLoading}" 
                    IsVisible="{Binding IsLoading}" 
                    HorizontalOptions="Center" 
                    VerticalOptions="Center"
                    Color="Blue"
                    HeightRequest="50"
                    WidthRequest="50"/>

                <!-- Movies -->
                <CollectionView ItemsSource="{Binding Movies}"
                                IsVisible="{Binding IsNotLoading}">
                    <CollectionView.ItemsLayout>
                        <GridItemsLayout Span="5" Orientation="Vertical"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Poster -->
                                <Border StrokeShape="RoundRectangle 10"
                                        StrokeThickness="0"
                                        HeightRequest="220"
                                        WidthRequest="150"
                                        BackgroundColor="Transparent">
                                    <Image Source="{Binding thumb_url}"
                                           Aspect="AspectFill"
                                           HeightRequest="220"
                                           WidthRequest="150"
                                           VerticalOptions="Center"
                                           HorizontalOptions="Center"/>
                                </Border>

                                <!-- Movie Name -->
                                <Label Grid.Row="1"
                                       Text="{Binding name}"
                                       FontSize="14"
                                       TextColor="#fff"
                                       FontAttributes="Bold"
                                       HorizontalTextAlignment="Center"
                                       LineBreakMode="TailTruncation"
                                       MaxLines="1"
                                       
                                       Margin="0,5,0,0"/>

                                <!-- Hover Effect -->
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup>
                                        <VisualState Name="Normal">
                                            <VisualState.Setters>
                                                <Setter Property="TranslationY" Value="0"/>
                                                <Setter Property="Scale" Value="1"/>
                                            </VisualState.Setters>
                                        </VisualState>
                                        <VisualState Name="PointerOver">
                                            <VisualState.Setters>
                                                <Setter Property="TranslationY" Value="-8"/>
                                                <Setter Property="Scale" Value="1.05"/>
                                            </VisualState.Setters>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <!-- Pagination -->
                <StackLayout Orientation="Horizontal" Margin="20" HorizontalOptions="Center" Spacing="15">

                    <!-- Prev Button -->
                    <Button x:Name="PrevButton1" Text="Trước"  Clicked="PrevButton_Clicked">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroupList>
                            <VisualStateGroup>
                                <VisualState x:Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="Opacity" Value="1"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Property="Opacity" Value="0.7"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            </VisualStateGroupList>
                        </VisualStateManager.VisualStateGroups>
                    </Button>

                    <!-- Page Labels -->
                    <Label x:Name="CurrentPageLabel" Text="1"  FontSize="20" VerticalOptions="Center"/>
                    <Label Text="/" FontSize="20"  VerticalOptions="Center"/>
                    <Label x:Name="TotalPagesLabel" Text="1"  FontSize="20" VerticalOptions="Center"/>

                    <!-- Next Button -->
                    <Button x:Name="NextButton" Text="Sau"  Clicked="NextButton_Clicked">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroupList>
                            <VisualStateGroup>
                                <VisualState x:Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="Opacity" Value="1"/>
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Property="Opacity" Value="0.7"/>
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                            </VisualStateGroupList>
                        </VisualStateManager.VisualStateGroups>
                    </Button>

                </StackLayout>
            </StackLayout>

            <StackLayout Margin="0,30,0,0" >
                
                <BoxView HeightRequest="2" 
             BackgroundColor="Gray" 
             HorizontalOptions="FillAndExpand"/>
            </StackLayout>

            <StackLayout Padding="0,20,0,0">
                <Grid HeightRequest="200" ColumnDefinitions="Auto,*" ColumnSpacing="20" VerticalOptions="Center">

                    <Image 
            Grid.Column="0"
            Source="movie04.png"
            Aspect="AspectFill"
            HeightRequest="200"
            WidthRequest="180"
            HorizontalOptions="Start"
            VerticalOptions="Center">
                        <Image.Clip>
                            <RoundRectangleGeometry CornerRadius="15" Rect="0,0,200,300"/>
                        </Image.Clip>
                    </Image>

                   
                    <StackLayout Grid.Column="1" Spacing="8" VerticalOptions="Center">
                        <Label 
                Text="🎬 AppPhimLo"
                FontSize="24"
                FontAttributes="Bold"
                TextColor="#2c3e50" />

                        <Label 
                Text="Ứng dụng xem phim trực tuyến với kho phim phong phú, cập nhật liên tục và tốc độ mượt mà."
                FontSize="14"
                TextColor="#34495e"
                HorizontalTextAlignment="Start"
                LineBreakMode="WordWrap" />

                        <BoxView HeightRequest="1" Color="#ddd" Margin="0,8"/>

                        <Label Text="📧 support@appphimlo.vn" FontSize="13" />
                        <Label Text="🌐 www.appphimlo.vn" FontSize="13" />
                        <Label Text="© 2025 AppPhimLo" FontSize="12" TextColor="#7f8c8d" />
                    </StackLayout>

                </Grid>
            </StackLayout>


        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
